---
title: "4.6.4 Docker Compose"
weight: 04060400
date: 2019-08-30T15:13:01+08:00
---

# docker compose

## 配置文件

```yaml
version: "3"

services:
  htzx:
    image: 127.0.0.1:15000/htzx/iot-device-access-service #指定容器运行的镜像。
    tty: true
    container_name: "iot-device-access-service" #自定义容器名称，而不是生成的默认名称。
    privileged: true
    environment: # 添加环境变量
      - TZ=Asia/Shanghai
    ports:
      - "15020:8080"
    extra_hosts: # 添加主机名映射。类似 docker client --add-host。
      - "consul:192.168.0.1"
    env_file: # 从文件添加环境变量。可以是单个值或列表的多个值。
      - ../env/common.env
    context: ./dir # 上下文路径。
    dockerfile: Dockerfile-alternate # 指定构建镜像的 Dockerfile 文件名。
    args: # 添加构建参数，这是只能在构建过程中访问的环境变量。
      buildno: 1
    labels: # 设置构建镜像的标签。
      - "com.example.description=Accounting webapp"
      - "com.example.department=Finance"
      - "com.example.label-with-empty-value"
    target: prod # 多层构建，可以指定构建哪一层。
    volumes: #将主机的数据卷或着文件挂载到容器里。
      - "/localhost/postgres.sock:/var/run/postgres/postgres.sock"
      - "/localhost/data:/var/lib/postgresql/data"

networks:
  default:
    external:
      name: hangtian
```

## 运行命令

```bash
docker-compose up -d # 后台执行服务

```
