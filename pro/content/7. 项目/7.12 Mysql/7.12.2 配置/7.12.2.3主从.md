## 主从

修改/etc/my.cnf，实现主主配置。
如果不存在/etc/my.cnf，则复制 support-files/my-default.cnf 生成 my.cnf，两台机器的 my.cnf 分别配置为（不难看到，只有 server_id 和 auto_increment_increment 两项不同）：
机器 A 机器 B
server-id=1 server-id=2
user=mysql user=mysql
log-bin=mysql-bin log-bin=mysql-bin
log-slave-updates log-slave-updates
slave-skip-errors=all slave-skip-errors=all
sync_binlog=1 sync_binlog=1
auto_increment_increment=1 auto_increment_increment=2
auto_increment_offset=1 auto_increment_offset=1

配置项 配置项说明
server-id 不能相同！唯一标识号，值位于 1~2^32-1 之间
user 这个可以不指定，则使用 mysqld_safe 指定的用户，或者 mysqld_safe 默认的用户 mysql
log-bin 启用二进制日志文件
log-slave-updates 配置从库上的更新操作是否写二进制文件，需要和 log-bin 一起使用
slave-skip-errors 值为 all 表示让从库跳过所有错误（但不能跳过所有 DDL 所引起的主从错误），也可以只跳过指定的错误，如：--slave-skip-errors=1062,1053；也可以配置只跳过 DDL 错误，如：--slave-skip-errors=ddl_exist_errors，这等同于：
--slave-skip-errors=1007,1008,1050,1051,1054,1060,1061,1068,1094,1146
sync_binlog 值为 1 表示主机每次提交事务的时候把二进制日志的内容同步到磁盘上
auto_increment_increment 和 auto_increment_offset 一起用于主主同步，用来错开自增，防止键值冲突，所以 auto_increment_increment 和 auto_increment_offset 两者，至少要有一项值不同。
auto_increment_offset

上述配置会导致同步所有的数据库，借助下列配置项也可以选择性的同步或不同步：
配置项 配置项说明
binlog-do-db=test1 表示只同步数据库 test1 和 test2，如果还想同步 test3，只需要新增一行：binlog-do-db=test3 即可
binlog-do-db=test2
binlog-ignore-db=db1 表示不同步数据库 db1 和 db2，如果还有 db3 不想同步，新增一行：binlog-ignore-db=db3 即可
binlog-ignore-db=db2

相关配置项（对于主从同步，只需要在从上配置）：replicate-do-db、replicate-ignore-db、replicate_wild_do_table 和 replicate_wild_ignore_table。

来自 <http://blog.csdn.net/Aquester/article/details/50674140>

master
vim /etc/my.cnf
server-id=1
log_bin=mysql-bin
log_slave-updates

GRANT FILE ON _._ TO 'repl*user'@'10.105.240.11' IDENTIFIED BY '8183ab0a79ed8461e15352832e91F5*#';
GRANT REPLICATION SLAVE ON _._ TO 'repl*user'@'10.105.240.11' IDENTIFIED BY '8183ab0a79ed8461e15352832e91F5*#';

SHOW VARIABLES LIKE '%log_bin%';
SHOW MASTER STATUS;

slave
stop slave;

show slave status

change master to master*host='10.105.19.157',master_port=27199,master_user='repl_user',master_password='8183ab0a79ed8461e15352832e91F5*#',master_log_file='mysql-bin.000021',master_log_pos=11288354;

START SLAVE;
