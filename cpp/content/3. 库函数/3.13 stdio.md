---
title: "3.13 stdio"
date: 2019-08-30T15:13:01+08:00
weight: 03130000
---


## atoi，atol，atof

    atoi()会扫描参数nptr字符串，检测到第一个数字或正负符号时开始做类型转换，之后检测到非数字或结束符 \0 时停止转换，返回整型数。

## itoa

    功能:把一整数转换为字符串
    用法:char *itoa(int value, char *string, int radix);
    详细解释:itoa是英文integer to array(将int整型数转化为一个字符串,并将值保存在数组string中)的缩写.
    参数：
    　　value: 待转化的整数。
    　　radix: 是基数的意思,即先将value转化为radix进制的数，范围介于2-36，比如10表示10进制，16表示16进制。
    　　* string: 保存转换后得到的字符串。
    　　返回值：
    　　char * : 指向生成的字符串， 同*string。
    　　备注:该函数的头文件是"stdlib.h"

## 四舍五入

```c++
 if( x > 0.0 )
                 return (int)( x + 0.5 );
         else
                 return (int)( x - 0.5 );
```

    头文件：#include <stdio.h>
    scanf() 函数用来格式化输入数据，即按用户指定的格式从键盘上把数据读入到指定的变量中。其原型为：
    int scanf ( char * format [ ,argument, ... ]);
    【参数】format为格式化控制字符串，可以由三类字符构成。

    1) 格式化说明符

    ------------------------------------------------------------

    格式字符           说明
    ------------------------------------------------------------

    %a                 读入一个浮点值(仅C99有效)
    %A                 同上
    %c                 读入一个字符
    %d                 读入十进制整数
    %i                 读入十进制，八进制，十六进制整数
    %o                 读入八进制整数
    %x                 读入十六进制整数
    %X                 同上
    %c                 读入一个字符
    %s                 读入一个字符串
    %f                 读入一个浮点数
    %F                 同上
    %e                 同上
    %E                 同上
    %g                 同上
    %G                 同上
    %p                 读入一个指针
    %u                 读入一个无符号十进制整数
    %n                 至此已读入值的等价字符数
    %[]                 扫描字符集合
    %%                读%符号

    另外，还有附加格式说明字符，用于追加在上面的格式说明符后面
    -----------------------------------------------------------------

    修饰符                       说明
    -----------------------------------------------------------------

    L/l                          长度修饰符，输入"长"数据
    h                            长度修饰符，输入"短"数据
    W                           整型常数，指定输入数据所占宽度

    * 星号，空读一个数据

    hh                          同 h，但仅对C99有效
    ll                             同 l，但仅对C99有效

    2) 空白字符
    空白字符会使scanf()函数在读操作中略去输入中的一个或多个空白字符，空白符可以是space,tab,newline等等，直到第一个非空白符出现为止。

    3) 非空白字符
    一个非空白字符会使scanf()函数在读入时剔除掉与这个非空白字符相同的字符。
    argument 为需要读入的所有变量的地址。
    注意，是变量地址，而不是变量标识符：
    如果是一般的变量，通常要在变量名前加上"&"取得地址，但输出时是用变量名。
    如果是数组，用数组名就代表了该数组的首地址，输出时也是用数组名
    如果是指针，直接用指针名本身，不要加上“*”，输出时也用该指针即可。
    【返回值】成功则返回被赋值的参数的个数。如果 format 和 argument 匹配错误，或者遇到结束符，那么返回值可能小于参数的个数。
    如果读取发生错误，将会返回 EOF，并设置错误标识，后续可以通过 ferror() 检测。
    如果遇到结束符，将会设置文件结束标识，后续可以通过 feof() 检测。
    如果在读取宽字符的时候发生编码错误，那么将会把 errno 设置为  EILSEQ。

    格式字符串
    格式字符串的一般形式为：
        %[*][输入数据宽度][长度]类型
    其中有方括号[]的项为任选项。各项的意义如下。

    1) 类型
    表示输入数据的类型，其格式符和意义如下表所示
    格式 字符意义
    d 输入十进制整数
    o 输入八进制整数
    x 输入十六进制整数
    u 输入无符号十进制整数
    f或e 输入实型数(用小数形式或指数形式)
    c 输入单个字符
    s 输入字符串
    2) “*”符
    用以表示该输入项，读入后不赋予相应的变量，即跳过该输入值。如：
    scanf("%d %*d %d",&a,&b);
    当输入为：1   2   3时，把1赋予a，2被跳过，3赋予b。

    3) 宽度
    用十进制整数指定输入的宽度（即字符数）。例如：
    scanf("%5d",&a);
    输入12345678只把12345赋予变量a，其余部分被截去。又如：
    scanf("%4d%4d",&a,&b);
    输入12345678将把1234赋予a，而把5678赋予b。
    4) 长度
    长度格式符为l和h，l表示输入长整型数据（如%ld）和双精度浮点数（如%lf）。h表示输入短整型数据。
    使用scanf函数还必须注意以下几点：
    scanf函数中没有精度控制，如：scanf("%5.2f",&a);是非法的。不能企图用此语句输入小数为2位的实数。
    scanf中要求给出变量地址，如给出变量名则会出错。如 scanf("%d",a);是非法的，应改为scnaf("%d",&a);才是合法的。
    在输入多个数值数据时，若格式控制串中没有非格式字符作输入数据之间的间隔则可用空格，TAB或回车作间隔。C编译在碰到空格，TAB，回车或非法数据(如对“%d”输入“12A”时，A即为非法数据)时即认为该数据结束。
    在输入字符数据时，若格式控制串中无非格式字符，则认为所有输入的字符均为有效字符。
    例如：
    scanf("%c%c%c",&a,&b,&c);
    输入 d、e、f 则把'd'赋予a，' ' 赋予b，'e'赋予c。只有当输入为 def 时，才能把'd'赋于a，'e'赋予b，'f'赋予c。
    如果在格式控制中加入空格作为间隔，如：
    scanf ("%c %c %c",&a,&b,&c);
    则输入时各数据之间可加空格。
    【例4-8】

    # include <stdio.h>

    int main(void)
    {
        char a,b;
        printf("input character a,b\n");
        scanf("%c%c",&a,&b);
        printf("%c%c\n",a,b);
        return 0;
    }
    由于scanf函数"%c%c"中没有空格，输入M  N，结果输出只有M。而输入改为MN时则可输出MN两字符。
    【例4-9】

    # include <stdio.h>

    int main(void){
        char a,b;
        printf("input character a,b\n");
        scanf("%c %c",&a,&b);
        printf("\n%c%c\n",a,b);
        return 0;
    }
    本例表示scanf格式控制串"%c %c"之间有空格时，输入的数据之间可以有空格间隔。
    5) 如果格式控制串中有非格式字符则输入时也要输入该非格式字符。
    例如：
    scanf("%d,%d,%d",&a,&b,&c);
    其中用非格式符“ , ”作间隔符，故输入时应为：5,6,7。又如：
    scanf("a=%d,b=%d,c=%d",&a,&b,&c);
    则输入应为：a=5,b=6,c=7。

## 简介

    stdio .h 头文件定义了三个变量类型、一些宏和各种函数来执行输入和输出。

## 库变量

    下面是头文件 stdio.h 中定义的变量类型：
    序号 变量 & 描述
    1 size_t 
    这是无符号整数类型，它是 sizeof 关键字的结果。
    2 FILE 
    这是一个适合存储文件流信息的对象类型。
    3 fpos_t 
    这是一个适合存储文件中任何位置的对象类型。

## 库宏

    下面是头文件 stdio.h 中定义的宏：
    序号 宏 & 描述
    1 NULL
    这个宏是一个空指针常量的值。
    2 _IOFBF、_IOLBF 和 _IONBF 
    这些宏扩展了带有特定值的整型常量表达式，并适用于 setvbuf 函数的第三个参数。
    3 BUFSIZ
    这个宏是一个整数，该整数代表了 setbuf 函数使用的缓冲区大小。
    4 EOFM 
    这个宏是一个表示已经到达文件结束的负整数。
    5 FOPEN_MAX 
    这个宏是一个整数，该整数代表了系统可以同时打开的文件数量。
    6 FILENAME_MAX 
    这个宏是一个整数，该整数代表了字符数组可以存储的文件名的最大长度。如果实现没有任何限制，则该值应为推荐的最大值。
    7 L_tmpnam 
    这个宏是一个整数，该整数代表了字符数组可以存储的由 tmpnam 函数创建的临时文件名的最大长度。
    8 SEEK_CUR、SEEK_END 和 SEEK_SET 
    这些宏是在These macros are used in the fseek 函数中使用，用于在一个文件中定位不同的位置。
    9 TMP_MAX 
    这个宏是 tmpnam 函数可生成的独特文件名的最大数量。
    10 stderr、stdin 和 stdout 
    这些宏是指向 FILE 类型的指针，分别对应于标准错误、标准输入和标准输出流。

## 库函数

    下面是头文件 stdio.h 中定义的函数：
    为了更好地理解函数，请按照下面的序列学习这些函数，因为第一个函数中创建的文件会在后续的函数中使用到。
    序号 函数 & 描述
    1 int fclose(FILE *stream)
    关闭流 stream。刷新所有的缓冲区。
    2 void clearerr(FILE *stream)
    清除给定流 stream 的文件结束和错误标识符。
    3 int feof(FILE *stream)
    测试给定流 stream 的文件结束标识符。
    4 int ferror(FILE *stream)
    测试给定流 stream 的错误标识符。
    5 int fflush(FILE *stream)
    刷新流 stream 的输出缓冲区。
    6 int fgetpos(FILE *stream, fpos_t *pos)
    获取流 stream 的当前文件位置，并把它写入到 pos。
    7 FILE *fopen(const char *filename, const char *mode)
    使用给定的模式 mode 打开 filename 所指向的文件。
    8 size_t fread(void *ptr, size_t size, size_t nmemb, FILE *stream)
    从给定流 stream 读取数据到 ptr 所指向的数组中。
    9 FILE *freopen(const char *filename, const char *mode, FILE *stream)
    把一个新的文件名 filename 与给定的打开的流 stream 关联，同时关闭流中的旧文件。
    10 int fseek(FILE *stream, long int offset, int whence)
    设置流 stream 的文件位置为给定的偏移 offset，参数 offset 意味着从给定的 whence 位置查找的字节数。
    11 int fsetpos(FILE *stream, const fpos_t *pos)
    设置给定流 stream 的文件位置为给定的位置。参数 pos 是由函数 fgetpos 给定的位置。
    12 long int ftell(FILE *stream)
    返回给定流 stream 的当前文件位置。
    13 size_t fwrite(const void *ptr, size_t size, size_t nmemb, FILE *stream)
    把 ptr 所指向的数组中的数据写入到给定流 stream 中。
    14 int remove(const char *filename)
    删除给定的文件名 filename，以便它不再被访问。
    15 int rename(const char *old_filename, const char *new_filename)
    把 old_filename 所指向的文件名改为 new_filename。
    16 void rewind(FILE *stream)
    设置文件位置为给定流 stream 的文件的开头。
    17 void setbuf(FILE *stream, char *buffer)
    定义流 stream 应如何缓冲。
    18 int setvbuf(FILE *stream, char *buffer, int mode, size_t size)
    另一个定义流 stream 应如何缓冲的函数。
    19 FILE *tmpfile(void)
    以二进制更新模式(wb+)创建临时文件。
    20 char *tmpnam(char *str)
    生成并返回一个有效的临时文件名，该文件名之前是不存在的。
    21 int fprintf(FILE *stream, const char *format, ...)
    发送格式化输出到流 stream 中。
    22 int printf(const char *format, ...)
    发送格式化输出到标准输出 stdout。
    23 int sprintf(char *str, const char *format, ...)
    发送格式化输出到字符串。
    24 int vfprintf(FILE *stream, const char *format, va_list arg)
    使用参数列表发送格式化输出到流 stream 中。
    25 int vprintf(const char *format, va_list arg)
    使用参数列表发送格式化输出到标准输出 stdout。
    26 int vsprintf(char *str, const char *format, va_list arg)
    使用参数列表发送格式化输出到字符串。
    27 int fscanf(FILE *stream, const char *format, ...)
    从流 stream 读取格式化输入。
    28 int scanf(const char *format, ...)
    从标准输入 stdin 读取格式化输入。
    29 int sscanf(const char *str, const char *format, ...)
    从字符串读取格式化输入。
    30 int fgetc(FILE *stream)
    从指定的流 stream 获取下一个字符（一个无符号字符），并把位置标识符往前移动。
    31 char *fgets(char *str, int n, FILE *stream)
    从指定的流 stream 读取一行，并把它存储在 str 所指向的字符串内。当读取 (n-1) 个字符时，或者读取到换行符时，或者到达文件末尾时，它会停止，具体视情况而定。
    32 int fputc(int char, FILE *stream)
    把参数 char 指定的字符（一个无符号字符）写入到指定的流 stream 中，并把位置标识符往前移动。
    33 int fputs(const char *str, FILE *stream)
    把字符串写入到指定的流 stream 中，但不包括空字符。
    34 int getc(FILE *stream)
    从指定的流 stream 获取下一个字符（一个无符号字符），并把位置标识符往前移动。
    35 int getchar(void)
    从标准输入 stdin 获取一个字符（一个无符号字符）。
    36 char *gets(char *str)
    从标准输入 stdin 读取一行，并把它存储在 str 所指向的字符串中。当读取到换行符时，或者到达文件末尾时，它会停止，具体视情况而定。
    37 int putc(int char, FILE *stream)
    把参数 char 指定的字符（一个无符号字符）写入到指定的流 stream 中，并把位置标识符往前移动。
    38 int putchar(int char)
    把参数 char 指定的字符（一个无符号字符）写入到标准输出 stdout 中。
    39 int puts(const char *str)
    把一个字符串写入到标准输出 stdout，直到空字符，但不包括空字符。换行符会被追加到输出中。
    40 int ungetc(int char, FILE *stream)
    把字符 char（一个无符号字符）推入到指定的流 stream 中，以便它是下一个被读取到的字符。
    41 void perror(const char *str)
    把一个描述性错误消息输出到标准错误 stderr。首先输出字符串 str，后跟一个冒号，然后是一个空格。
