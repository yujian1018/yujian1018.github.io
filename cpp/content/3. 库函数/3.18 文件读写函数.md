---
title: "3.18 文件读写函数"
date: 2019-08-30T15:13:01+08:00
weight: 03180000
---

## 文件读写函数

    fopen FILE *fopen(char *filename, char *mode); 函数用来打开一个文件
    fclose int fclose(FILE *fp);  
    fgetc() int fgetc (FILE *fp); 函数每次只能读写一个字符
    fputc() int fputc ( int ch, FILE *fp ); 函数每次只能读写一个字符
    fgets char *fgets ( char *str, int n, FILE *fp ); 有局限性，每次最多只能从文件中读取一行内容，因为 fgets 遇到换行符就结束读取。
    fputs int fputs( char *str, FILE *fp ); 
    fread size_t fread ( void *ptr, size_t size, size_t count, FILE *fp );  读取多行内容
    fwrite size_t fwrite ( void * ptr, size_t size, size_t count, FILE *fp ); 
    rewind(fp); void rewind ( FILE *fp ); //将文件中的位置指针重新定位到文件开头
    fseek()  int fseek ( FILE *fp, long offset, int origin ); 来将位置指针移动到任意位置
            offset 为偏移量，也就是要移动的字节数。之所以为 long 类型，是希望移动的范围更大，能处理的文件更大
            origin 为起始位置
            
            文件开头 SEEK_SET 0
            当前位置 SEEK_CUR 1
            文件末尾 SEEK_END 2
    fscanf int fscanf ( FILE *fp, char * format, ... ); FILE *fp;
            int i, j;
            char *str, ch;
            fscanf(fp, "%d %s", &i, str);
            fprintf(fp,"%d %c", j, ch);
    fprintf() int fprintf ( FILE *fp, char * format, ... ); 
            
            


    它的原型为：FILE *fopen(char *filename, char *mode);
    Filename为文件名（包括文件路径），mode为打开方式，它们都是字符串。
    fopen() 会获取文件信息，包括文件名、文件状态、当前读写位置等，并将这些信息保存到一个FILE类型的结构体变量中，然后将该变量的地址返回。
    FILE是在stdio.h头文件中定义的一个结构体，用来保存文件信息。
    如果希望接收 fopen() 的返回值，就需要定义一个 FILE 类型的指针。
    例如：
    FILE *fp = ("demo.txt", "r");表示以“只读”方式打开当前目录下的 demo.txt 文件，并使 fp 指向该文件，这样就可以通过 fp 来操作 demo.txt 了。
    fp 通常被称为文件指针。
    又如：FILE *fp = fopen("D:\\demo.txt","rb");表示以二进制方式打开 D 盘下的 demo.txt 文件，允许读和写。


    打开方式 说明
    r 以只读方式打开文件，只允许读取，不允许写入。该文件必须存在。
    r+ 以读/写方式打开文件，允许读取和写入。该文件必须存在。
    rb+ 以读/写方式打开一个二进制文件，允许读/写数据。
    rt+ 以读/写方式打开一个文本文件，允许读和写。
    w 以只写方式打开文件，若文件存在则长度清为0，即该文件内容消失，若不存在则创建该文件。
    w+ 以读/写方式打开文件，若文件存在则文件长度清为零，即该文件内容会消失。若文件不存在则建立该文件。
    a 以追加的方式打开只写文件。若文件不存在，则会建立该文件，如果文件存在，写入的数据会被加到文件尾，即文件原先的内容会被保留（EOF符保留)。
    a+ 以追加方式打开可读/写的文件。若文件不存在，则会建立该文件，如果文件存在，则写入的数据会被加到文件尾后，即文件原先的内容会被保留（原来的EOF符 不保留)。
    wb 以只写方式打开或新建一个二进制文件，只允许写数据。
    wb+ 以读/写方式打开或建立一个二进制文件，允许读和写。
    wt+ 以读/写方式打开或建立一个文本文件，允许读写。
    at+ 以读/写方式打开一个文本文件，允许读或在文本末追加数据。
    ab+ 以读/写方式打开一个二进制文件，允许读或在文件末追加数据。


    1) 文件打开方式由r、w、a、t、b、+ 六个字符拼成，各字符的含义是：
        • r(read)：读
        • w(write)：写
        • a(append)：追加
        • t(text)：文本文件，可省略不写
        • b(banary)：二进制文件
        • +：读和写

    2) 如果没有“b”字符，文件以文本方式打开。

    3) 凡用“r”打开一个文件时，该文件必须已经存在。

    4) 在打开一个文件时，如果出错，fopen将返回一个空指针值NULL。在程序中可以用这一信息来判别是否完成打开文件的工作，并作相应的处理。

    5) 把一个文本文件读入内存时，要将ASCII码转换成二进制码，而把文件以文本方式写入磁盘时，也要把二进制码转换成ASCII码，因此文本文件的读写要花费较多的转换时间。对二进制文件的读写不存在这种转换。

    6) 标准输入文件 stdin（键盘）、标准输出文件 stdout（显示器）、标准错误文件 stderr（显示器）是由系统打开的，可直接使用。
